<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Briefing & Or√ßamento | DN Dev</title>
<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
  *{box-sizing:border-box;margin:0;padding:0;font-family:Poppins,Arial,sans-serif;}
  body{
    background: linear-gradient(135deg,#1a3c6b,#3c7dcf);
    min-height:100vh;
    padding:28px;
    display:flex;
    justify-content:center;
    align-items:flex-start;
    color:#fff;
  }
  .card{
    background:#fff;
    border-radius:14px;
    max-width:900px;
    width:100%;
    padding:28px;
    box-shadow:0 12px 40px rgba(0,0,0,0.08);
    color:#0b2340;
    position:relative;
  }
  h1{font-size:22px;margin-bottom:10px;}
  label{display:block;margin-top:12px;font-weight:600;}
  input[type=text], input[type=number], textarea, select{
    width:100%;
    padding:10px 12px;
    margin-top:6px;
    border-radius:10px;
    border:1px solid #d6e3f7;
    font-size:14px;
    background:#fbfdff;
  }
  textarea{min-height:72px;resize:vertical;}
  .campo-dinamico{display:flex;gap:8px;align-items:center;margin-top:6px;}
  .campo-dinamico input{flex:1;}
  .btn-download{
    background:#1e88e5;
    color:white;
    width:100%;
    margin-top:18px;
    font-size:15px;
    padding:12px 16px;
    border-radius:10px;
    border:none;
    cursor:pointer;
    font-weight:700;
    transition:.18s;
  }
  .btn-download:hover{transform:translateY(-2px);filter:brightness(.96);}
  .right{
    background:#fbfdff;
    border-radius:12px;
    padding:14px;
    border:1px solid #ecf4ff;
    margin-top:20px;
    color:#013a63;
  }
  .price{display:flex;align-items:baseline;gap:8px;}
  .price .big{font-size:26px;font-weight:800;}
  .price .small{font-size:13px;color:#345e7a;opacity:.9;}
  .flex-row{
    display:flex;
    align-items:center;
    gap:8px;
    margin:4px 0;
    font-size:14px;
    color:#235272;
  }
  .installments{margin-top:10px;font-size:13px;color:#233b4e;}
  pre.json{
    margin-top:12px;
    background:#f7fbff;
    border:1px solid #e6f4ff;
    padding:10px;
    border-radius:8px;
    max-height:190px;
    overflow:auto;
    font-size:12px;
    color:#234;
  }
  ul.animated-list li{
    opacity:0;
    transform: translateY(-10px);
    transition: all 0.3s ease;
  }
  ul.animated-list li.show{
    opacity:1;
    transform: translateY(0);
  }
  footer.watermark{
    position:fixed;
    bottom:0;
    left:0;
    width:100%;
    text-align:center;
    background:rgba(30,136,229,0.9);
    color:#fff;
    font-weight:700;
    font-size:14px;
    padding:8px 0;
    display:none;
    z-index:999;
    transition: all 0.4s ease;
  }
  footer.watermark.active{display:block;}
</style>
</head>
<body>
<div id="app" class="card">
  <h1>Preencha o briefing e obtenha o or√ßamento</h1>

  <!-- FORMUL√ÅRIO EXISTENTE -->
  <label>Nome do Cliente</label>
  <input type="text" v-model="form.cliente" placeholder="Ex: Jo√£o da Silva">

  <label>Nome do Projeto / Empresa</label>
  <input type="text" v-model="form.nomeProjeto" placeholder="Ex: Cl√≠nica Sorriso">

  <label>Estilo desejado</label>
  <select v-model="form.estilo">
    <option value="">Selecione</option>
    <option value="moderno">Moderno / Clean</option>
    <option value="profissional">Profissional / Corporativo</option>
    <option value="criativo">Criativo / Colorido</option>
    <option value="minimalista">Minimalista</option>
  </select>

  <label>Espectro de cores</label>
  <select v-model="form.cores">
    <option value="">Selecione</option>
    <option value="azuis">Tons azuis</option>
    <option value="neutros">Neutros</option>
    <option value="vibrantes">Vibrantes</option>
    <option value="pastel">Pastel</option>
    <option value="outro">Outro (digite abaixo)</option>
  </select>
  <div v-if="form.cores==='outro'" class="campo-dinamico">
    <input type="text" v-model="form.coresOutro" placeholder="Descreva aqui os tons desejados">
  </div>

  <!-- NOVO: Janelas Din√¢micas -->
  <label>Janelas do Site</label>
  <div class="campo-dinamico">
    <input type="text" v-model="novaJanela" placeholder="Ex: Contato, Sobre n√≥s...">
    <button type="button" @click="adicionarJanela">Adicionar</button>
  </div>
  <ul class="animated-list">
    <li v-for="(janela, index) in janelas" :key="index" :class="{show:true}">
      {{ janela }}
    </li>
  </ul>
  <p>Total de janelas: {{ janelas.length }}</p>

  <label>Quantas p√°ginas?</label>
  <div class="campo-dinamico">
    <input type="number" min="1" v-model.number="form.numeroPaginas">
    <div style="font-size:13px;color:#6d8596;">(3 p√°ginas b√°sicas inclusas)</div>
  </div>

  <!-- Funcionalidades com checkbox ao lado -->
  <label>Funcionalidades extras</label>
  <div>
    <label class="flex-row">
      <input type="checkbox" v-model="form.funcionalidades" value="formContato">
      Formul√°rio de contato
    </label>
    <label class="flex-row">
      <input type="checkbox" v-model="form.funcionalidades" value="whatsapp">
      Integra√ß√£o WhatsApp
    </label>
    <label class="flex-row">
      <input type="checkbox" v-model="form.funcionalidades" value="login">
      Login / √Årea restrita
    </label>
    <label class="flex-row">
      <input type="checkbox" v-model="form.funcionalidades" value="cadastro">
      Sistema de cadastro
    </label>
    <label class="flex-row">
      <input type="checkbox" v-model="form.funcionalidades" value="galeria">
      Galeria de imagens
    </label>
    <label class="flex-row">
      <input type="checkbox" v-model="form.funcionalidades" value="blog">
      Blog / Not√≠cias
    </label>
  </div>

  <!-- Complexidade -->
  <label>Complexidade do design</label>
  <select v-model="form.complexidade">
    <option value="basico">B√°sico</option>
    <option value="custom">Custom</option>
    <option value="premium">Premium</option>
  </select>
  <div style="margin-top:4px;color:#345e7a;font-size:13px;">
    {{ descricaoComplexidade }}
  </div>

  <label>Refer√™ncias / Observa√ß√µes</label>
  <textarea v-model="form.referencias" placeholder="Cole links ou descreva o que gosta"></textarea>

  <button class="btn-download" @click="gerarPDF">üìÅ Gerar PDF do or√ßamento</button>

  <!-- RESUMO -->
  <div class="right">
    <div class="price">
      <div class="big">R$ {{ displayPrice }}</div>
      <div class="small">Or√ßamento estimado</div>
    </div>
    <ul class="features">
      <li>Base inicial: R$ 900 (at√© 3 p√°ginas)</li>
      <li>P√°ginas extras: R$ {{ extraPerPage }} cada</li>
      <li>Complexidade: {{ complexityLabel }}</li>
      <li>Funcionalidades: {{ featureLabelsText }}</li>
      <li v-if="janelas.length>0">Janelas: {{ janelas.join(', ') }}</li>
    </ul>
    <div class="installments">
      <strong>Parcelamento at√© 5x sem juros:</strong>
      <ul>
        <li v-for="n in 5" v-if="price>=n" :key="n">
          {{ n }}x: R$ {{ (price/n).toFixed(2) }}
        </li>
      </ul>
    </div>
    <pre class="json">{{ exportPreview }}</pre>
  </div>

  <footer class="watermark" :class="{active: showWatermark}">
    DN Dev üíª
  </footer>
</div>

<script>
const { createApp } = Vue;
createApp({
  data(){
    return {
      showWatermark:false,
      baseMin:900,
      baseMax:5000,
      extraPerPage:120,
      featureCosts:{formContato:120,whatsapp:80,login:350,cadastro:300,galeria:110,blog:140},
      complexityCosts:{basico:0,custom:220,premium:380},
      form:{
        cliente:"",
        nomeProjeto:"",
        estilo:"",
        cores:"",
        coresOutro:"",
        numeroPaginas:3,
        funcionalidades:[],
        complexidade:"basico",
        referencias:""
      },
      janelas:[],
      novaJanela:""
    }
  },
  computed:{
    featuresCost(){return this.form.funcionalidades.reduce((s,f)=>s+(this.featureCosts[f]||0),0)},
    pagesExtraCost(){return Math.max(0,(this.form.numeroPaginas-3)*this.extraPerPage)},
    complexityCost(){return this.complexityCosts[this.form.complexidade]||0},
    estimatedRaw(){return this.baseMin+this.pagesExtraCost+this.featuresCost+this.complexityCost},
    price(){let p=Math.round(this.estimatedRaw);if(p>this.baseMax)p=this.baseMax;return p},
    displayPrice(){return this.price.toLocaleString('pt-BR')},
    featureLabelsText(){return this.form.funcionalidades.map(f=>f.replace(/([A-Z])/g," $1")).join(", ")||"Nenhuma"},
    complexityLabel(){return this.form.complexidade.charAt(0).toUpperCase()+this.form.complexidade.slice(1)},
    descricaoComplexidade(){
      const d={
        basico:"üí° Site com at√© 3 p√°ginas e design simples.",
        custom:"‚ú® Design personalizado, at√© 6 p√°ginas e pequenas intera√ß√µes.",
        premium:"üöÄ Site completo com anima√ß√µes, SEO e otimiza√ß√£o de desempenho."
      };
      return d[this.form.complexidade]||"";
    },
    exportPreview(){return JSON.stringify({...this.form,janelas:this.janelas},null,2)}
  },
  methods:{
    adicionarJanela(){
      const nome = this.novaJanela.trim();
      if(!nome)return;
      this.janelas.push(nome);
      this.novaJanela="";
    },
    gerarPDF(){
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.setFontSize(16);
      doc.text("Resultado do or√ßamento do site",14,20);
      doc.setFontSize(12);

      const complexity = this.form.complexidade.charAt(0).toUpperCase()+this.form.complexidade.slice(1);

      const lines = [
        `Cliente: ${this.form.cliente}`,
        `Projeto / Empresa: ${this.form.nomeProjeto}`,
        `Estilo: ${this.form.estilo}`,
        `Cores: ${this.form.cores==='outro'?this.form.coresOutro:this.form.cores}`,
        `P√°ginas: ${this.form.numeroPaginas}`,
        `Complexidade: ${complexity || 'B√°sico'}`,
        `Funcionalidades: ${this.featureLabelsText}`,
        this.janelas.length>0?`Janelas: ${this.janelas.join(', ')}`:"",
        `Refer√™ncias / Observa√ß√µes: ${this.form.referencias}`,
        `Valor total: R$ ${this.price.toLocaleString('pt-BR')}`
      ];

      let y=30;
      lines.forEach(line => { if(line) { doc.text(line,14,y); y+=8; }});

      doc.setFont("times","italic");
      doc.setFontSize(12);
      doc.text("Desenvolvido por DN Dev",14,y+10);

      doc.save("orcamento_dn_dev.pdf");
      this.showWatermark=true;
      window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    },
    checkScroll(){
      const scrollBottom = window.innerHeight + window.scrollY;
      const docHeight = document.body.offsetHeight;
      if(scrollBottom >= docHeight - 10){
        this.showWatermark = true;
      }
    }
  },
  mounted(){
    window.addEventListener('scroll', this.checkScroll);
  },
  beforeUnmount(){
    window.removeEventListener('scroll', this.checkScroll);
  }
}).mount('#app');
</script>
</body>
</html>
